{% extends 'warehouse/base.html' %}
{% block title %}Добавить запчасть{% endblock %}
{% block content %}
{% load static %}
    <link rel="stylesheet" href="{% static 'css/add_part.css' %}">
<div class="container mt-3 mb-4"> <!-- Уменьшен верхний и нижний отступы контейнера -->
    <h2 class="mb-3 text-center ">Добавить запчасть</h2> <!-- Уменьшен нижний отступ для заголовка -->

    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}

                <div class="form-group mb-3 row">
            <label for="id_part_number" class="col-sm-2 col-form-label">Номер запчасти:</label>
            <div class="col-sm-8">
                {{ form.part_number }}
            </div>
        </div>

        <!-- Устройство -->
        <div class="form-group mb-3 row">
            <label for="id_device" class="col-sm-2 col-form-label">Устройство:</label>
            <div class="col-sm-8">
                <input list="devices" id="id_device" name="device" class="form-control shadow-sm" placeholder="Введите устройство" required>
                <datalist id="devices">
                    <option value="Телефон">
                    <option value="Планшет">
                    <option value="Смарт-часы">
                </datalist>
            </div>
        </div>

        <!-- Бренд -->
        <div class="form-group mb-3 row">
            <label for="id_brand" class="col-sm-2 col-form-label">Бренд:</label>
            <div class="col-sm-8">
                <input list="brands" id="id_brand" name="brand" class="form-control shadow-sm" placeholder="Введите бренд" required>
                <datalist id="brands"></datalist>
            </div>
        </div>

        <!-- Модель -->
        <div class="form-group mb-3 row">
            <label for="id_model" class="col-sm-2 col-form-label">Модель:</label>
            <div class="col-sm-8">
                <input list="models" id="id_model" name="model" class="form-control shadow-sm" placeholder="Введите модель" required>
                <datalist id="models"></datalist>
            </div>
        </div>

        <!-- Тип запчасти -->
        <div class="form-group mb-3 row">
            <label for="id_part_type" class="col-sm-2 col-form-label">Тип запчасти:</label>
            <div class="col-sm-8">
                <input list="part_types" id="id_part_type" name="part_type" class="form-control shadow-sm" placeholder="Введите тип запчасти" required>
                <datalist id="part_types"></datalist>
            </div>
        </div>

        <!-- Цвет -->
        <div class="form-group mb-3 row" id="color_input_container"  style="display: none;">
            <label for="id_color" class="col-sm-2 col-form-label">Цвет:</label>
            <div class="col-sm-8">
                <input type="text" id="id_color" name="color" list="colors" class="form-control shadow-sm" placeholder="Введите цвет (если нужно)">
                <datalist id="colors"></datalist>
            </div>
        </div>

        <!-- Маркировка микросхемы -->
        <div id="chip_marking_container" class="form-group mb-3 row" style="display: none;">
            <label for="id_chip_marking" class="col-sm-2 col-form-label">Маркировка микросхемы:</label>
            <div class="col-sm-8">
                <input type="text" id="id_chip_marking" name="chip_marking" class="form-control shadow-sm" placeholder="Введите маркировку микросхемы">
            </div>
        </div>

        <!-- Состояние -->
        <div class="form-group mb-3 row">
            <label for="id_condition" class="col-sm-2 col-form-label">Состояние:</label>
            <div class="col-sm-8">
                <input list="conditions" id="id_condition" name="condition" class="form-control shadow-sm" placeholder="Выберите состояние" required>
                <datalist id="conditions"></datalist>
            </div>
        </div>

        <!-- Количество -->
        <div class="form-group mb-3 row">
            <label for="id_quantity" class="col-sm-2 col-form-label">Количество:</label>
            <div class="col-sm-8">
                <input type="number" name="quantity" id="id_quantity" class="form-control shadow-sm" placeholder="Введите количество" min="1" required>
            </div>
        </div>

        <!-- Цена -->
        <div class="form-group mb-3 row">
            <label for="id_price" class="col-sm-2 col-form-label">Цена:</label>
            <div class="col-sm-8">
                <div class="input-group">
                    <input type="number" name="price" id="id_price" class="form-control shadow-sm" placeholder="Введите цену" step="1" min="0" required>
                    <span class="input-group-text">бел.руб.</span>
                </div>
            </div>
        </div>

        <!-- Примечание -->
        <div class="form-group mb-3 row">
            <label for="id_note" class="col-sm-2 col-form-label">Примечание:</label>
            <div class="col-sm-8">
                <textarea name="note" id="id_note" class="form-control shadow-sm" rows="3" placeholder="Введите примечание"></textarea>
            </div>
        </div>
<!-- Телеграм-стильный переключатель -->
<div class="form-group mb-4 row">
  <div class="col-sm-2"></div>
  <div class="col-sm-8">

    <label class="tg-switch-wrapper">

      <input
        type="checkbox"
        id="id_send_to_telegram"
        name="send_to_telegram"
        class="tg-switch-input"
        {% if request.method == 'POST' and request.POST.send_to_telegram %}checked{% endif %}
      >

      <span class="tg-switch-slider"></span>

      <span class="tg-switch-label">
        <img src="https://cdn-icons-png.flaticon.com/512/2111/2111646.png"
             alt="TG"
             class="tg-icon">
        Показать запчасть в Telegram чате
      </span>

    </label>

  </div>
</div>

<style>
/* Контейнер */
.tg-switch-wrapper {
  display: flex;
  align-items: center;
  gap: 12px;
  cursor: pointer;
  user-select: none;
}

/* Иконка Telegram */
.tg-icon {
  width: 22px;
  height: 22px;
  margin-right: 5px;
  opacity: 0.9;
}

/* Скрытый чекбокс */
.tg-switch-input {
  display: none;
}

/* Ползунок */
.tg-switch-slider {
  width: 48px;
  height: 26px;
  background: #cdd5df;
  border-radius: 50px;
  position: relative;
  transition: 0.25s;
  box-shadow: inset 0 0 4px rgba(0,0,0,0.15);
}

/* Круг внутри */
.tg-switch-slider::before {
  content: "";
  width: 22px;
  height: 22px;
  background: #fff;
  border-radius: 50%;
  position: absolute;
  top: 2px;
  left: 2px;
  transition: 0.25s;
  box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

/* Активное состояние */
.tg-switch-input:checked + .tg-switch-slider {
  background: #2AABEE; /* Цвет Telegram */
}

.tg-switch-input:checked + .tg-switch-slider::before {
  transform: translateX(22px);
}

/* Текст */
.tg-switch-label {
  font-size: 16px;
  color: #2a2a2a;
  display: flex;
  align-items: center;
}
</style>



        <!-- Загрузка изображений -->
        <div class="form-group mb-3">
            <label class="form-label">Добавьте фотографии:</label>
            <!-- Выводим поясняющий текст один раз -->
            <small class="form-text text-muted mb-2">
                Размер файла не должен превышать 5 МБ. Допустимые форматы: JPEG, JPG, PNG, WEBP, HEIC.
            </small>
            {{ formset.management_form }}
            <div class="row">
                {% for form in formset %}
                <div class="col-md-12 mb-3">
                    <label for="{{ form.image.id_for_label }}" class="form-label">Фото:</label>
                    {{ form.image }}
                    {% if form.image.errors %}
                        <div class="text-danger">
                            {% for error in form.image.errors %}
                                <p>{{ error }}</p>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>



        <!-- Кнопка добавления -->
        <div class="text-center">
            <button type="submit" class="btn btn-primary btn-lg px-5">Добавить запчасть</button>
        </div>
    </form>
</div>

<script src="{% static 'js/add_part.js' %}"></script>
{% endblock %}
