{% extends 'warehouse/base.html' %}

{% block title %}Запчасти пользователя {{ viewed_user.username }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-4 text-center">Запчасти пользователя {{ user.profile.full_name|default:user.username }}</h2>

<form method="get" action="{% url 'search_user_parts' viewed_user.id %}" class="mb-4 d-flex">
    <input type="text" name="query" class="form-control form-control-sm" style="width: 25%;" placeholder="Поиск по модели или типу запчасти" value="{{ request.GET.query }}">
    <button type="submit" class="btn btn-primary btn-sm" style="margin-left: 10px;">Искать</button>
</form>

    {% if grouped_parts %}
        {% for device, brands in grouped_parts.items %}
            <div class="device-section mb-5">
                <h3 class="text-primary">{{ device }}</h3>
                {% for brand, parts in brands.items %}
                    <div class="brand-section">
                        <h4 class="ml-3 text-success">{{ brand }}</h4>
                        <table class="table table-bordered table-striped table-hover">
                            <thead class="thead-dark">
                                <tr>
                                    <th>Модель</th>
                                    <th>Тип запчасти</th>
                                    <th>Цвет</th>
                                    <th>Количество</th>
                                    <th>Цена</th>
                                    <th>Детали</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for part in parts %}
                                    <tr>
                                        <td>{{ part.display_model }}</td>
                                        <td>{{ part.part_type }}</td>
                                        <td>{{ part.color }}</td>
                                        <td>{{ part.quantity }}</td>
                                        <td>{{ part.price }}</td>
                                        <td><a href="{% url 'part_detail' part.id %}" class="btn btn-info btn-sm">Подробнее</a></td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% endfor %}
            </div>
        {% endfor %}
    {% else %}
        <p>У пользователя {{ viewed_user.username }} нет добавленных запчастей.</p>
    {% endif %}
</div>
{% endblock %}
