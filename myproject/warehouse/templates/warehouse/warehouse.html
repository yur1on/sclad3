{% extends 'warehouse/base.html' %}
{% block title %}–°–∫–ª–∞–¥{% endblock %}
{% block content %}
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="mb-0">–í–∞—à–∏ –∑–∞–ø—á–∞—Å—Ç–∏</h2>
        <a href="{% url 'add_part' %}" class="btn btn-success">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø—á–∞—Å—Ç—å</a>
    </div>

    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –ø–æ–∏—Å–∫–∞ -->
    <div class="mb-4">
        <form method="get" class="form-row">
            <!-- –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ -->
            <div class="form-group col-md-3">
                <label for="device">–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</label>
                <div class="input-group">
                    <input type="text" list="devices" name="q" id="device" class="form-control" placeholder="–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ" value="{{ query|default_if_none:'' }}">
                    <datalist id="devices">
                        <option value="–¢–µ–ª–µ—Ñ–æ–Ω">
                        <option value="–ü–ª–∞–Ω—à–µ—Ç">
                        <option value="–ù–æ—É—Ç–±—É–∫">
                        <option value="–°–º–∞—Ä—Ç-—á–∞—Å—ã">
                    </datalist>
                </div>
            </div>

            <!-- –ë—Ä–µ–Ω–¥ -->
            <div class="form-group col-md-2">
                <label for="brand">–ë—Ä–µ–Ω–¥</label>
                <div class="input-group">
                    <input list="brands" name="brand" id="brand" class="form-control" placeholder="–ë—Ä–µ–Ω–¥" value="{{ brand|default_if_none:'' }}">
                    <datalist id="brands">
                        <option value="Samsung">
                        <option value="Huawei">
                        <option value="Xiaomi">
                    </datalist>
                </div>
            </div>

            <!-- –ú–æ–¥–µ–ª—å -->
            <div class="form-group col-md-2">
                <label for="model">–ú–æ–¥–µ–ª—å</label>
                <div class="input-group">
                    <input list="models" name="model" id="model" class="form-control" placeholder="–ú–æ–¥–µ–ª—å" value="{{ model|default_if_none:'' }}">
                    <datalist id="models">
                        <!-- –ú–æ–¥–µ–ª–∏ –±—É–¥—É—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ JavaScript -->
                    </datalist>
                </div>
            </div>

            <!-- –¢–∏–ø –∑–∞–ø—á–∞—Å—Ç–∏ -->
            <div class="form-group col-md-3">
                <label for="part_type">–¢–∏–ø –∑–∞–ø—á–∞—Å—Ç–∏</label>
                <div class="input-group">
                    <input list="part_types" name="part_type" id="part_type" class="form-control" placeholder="–¢–∏–ø –∑–∞–ø—á–∞—Å—Ç–∏" value="{{ part_type|default_if_none:'' }}">
                    <datalist id="part_types">
                        <option value="–î–∏–Ω–∞–º–∏–∫">
                        <option value="–î–∏—Å–ø–ª–µ–π">
                        <option value="–ú–∏–∫—Ä–æ—Ñ–æ–Ω">
                        <option value="–°—Ç–µ–∫–ª–æ">
                        <option value="–®–ª–µ–π—Ñ –º–µ–∂–ø–ª–∞—Ç–Ω—ã–π">
                        <option value="–®–ª–µ–π—Ñ –¥–∏—Å–ø–ª–µ—è">
                        <option value="–®–ª–µ–π—Ñ –æ—Ç–ø–µ—á–∞—Ç–∫–∞ –ø–∞–ª—å—Ü–∞">
                        <option value="–ö—Ä—ã—à–∫–∞ –∑–∞–¥–Ω—è—è">
                        <option value="–†–∞–º–∫–∞ –¥–∏—Å–ø–ª–µ—è">
                        <option value="–ö–æ—Ä–ø—É—Å">
                        <option value="–ö–∞–º–µ—Ä–∞ –æ—Å–Ω–æ–≤–Ω–∞—è">
                        <option value="–ö–∞–º–µ—Ä–∞ —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–∞—è">
                    </datalist>
                </div>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∞ –ø–æ–∏—Å–∫–∞ -->
            <div class="form-group col-md-2 d-flex align-items-end">
                <button type="submit" class="btn btn-primary btn-block">–ü–æ–∏—Å–∫</button>
            </div>
        </form>
    </div>

    <!-- –¢–∞–±–ª–∏—Ü–∞ –∑–∞–ø—á–∞—Å—Ç–µ–π -->
    <div class="table-responsive">
        <table id="parts-table" class="table table-striped table-bordered">
            <thead class="thead-dark">
                <tr>
                    <th onclick="sortTable(0)">–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</th>
                    <th onclick="sortTable(1)">–ë—Ä–µ–Ω–¥</th>
                    <th onclick="sortTable(2)">–ú–æ–¥–µ–ª—å</th>
                    <th onclick="sortTable(3)">–¢–∏–ø –∑–∞–ø—á–∞—Å—Ç–∏</th>
                    <th onclick="sortTable(4)">–¶–≤–µ—Ç</th>
                    <th onclick="sortTable(5)">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                    <th onclick="sortTable(6)">–¶–µ–Ω–∞</th>
                    <th>–§–æ—Ç–æ</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
            </thead>
            <tbody>
                {% for part in parts %}
                <tr>
                    <td>{{ part.device }}</td>
                    <td>{{ part.brand }}</td>
                    <td>{{ part.model }}</td>
                    <td>{{ part.part_type }}</td>
                    <td>{{ part.color|default:"–ù–µ —É–∫–∞–∑–∞–Ω" }}</td>
                    <td>{{ part.quantity }}</td>
                    <td>{{ part.price }}</td>
                    <td>
                        {% if part.image %}
                            <a href="{{ part.image.url }}" target="_blank" class="img-link">
                                <img src="{{ part.image.url }}" alt="{{ part.model }}" class="img-thumbnail" style="max-width: 100px; max-height: 100px;">
                            </a>
                        {% else %}
                            –ù–µ—Ç —Ñ–æ—Ç–æ
                        {% endif %}
                    </td>
                    <td>
                        <a href="{% url 'edit_part' part.id %}" class="btn btn-sm btn-warning mb-1" data-toggle="tooltip" data-placement="top" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">‚úèÔ∏è</a>
                        <a href="{% url 'delete_part' part.id %}" class="btn btn-sm btn-danger" data-toggle="tooltip" data-placement="top" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="9" class="text-center">–ó–∞–ø—á–∞—Å—Ç–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- –í–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–¥—Å–∫–∞–∑–æ–∫ –¥–ª—è –∫–Ω–æ–ø–æ–∫ -->
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip();
        });

        function sortTable(n) {
            var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
            table = document.getElementById("parts-table");
            switching = true;
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è:
            dir = "asc";
            while (switching) {
                switching = false;
                rows = table.rows;
                // –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –≤—Å–µ–º —Å—Ç—Ä–æ–∫–∞–º —Ç–∞–±–ª–∏—Ü—ã, –∫—Ä–æ–º–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞:
                for (i = 1; i < (rows.length - 1); i++) {
                    shouldSwitch = false;
                    x = rows[i].getElementsByTagName("TD")[n];
                    y = rows[i + 1].getElementsByTagName("TD")[n];
                    if (dir == "asc") {
                        if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                            shouldSwitch = true;
                            break;
                        }
                    } else if (dir == "desc") {
                        if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                            shouldSwitch = true;
                            break;
                        }
                    }
                }
                if (shouldSwitch) {
                    rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                    switching = true;
                    switchcount ++;
                } else {
                    if (switchcount == 0 && dir == "asc") {
                        dir = "desc";
                        switching = true;
                    }
                }
            }
        }
    </script>
{% endblock %}
